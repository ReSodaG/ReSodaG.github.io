---
title: how to use git
tags:
---
## 如何使用 Git

关于如何使用 Git 我专门在一个[测试项目](https://github.com/Storh/git-example)中进行了尝试，并保持了提交记录提交在 GitHub 上，这个项目的内容就是用来描述 Git 的命令和操作。为了方便测试分支和协作，我一共准备了3个用户来对项目进行修改，分别是我本人、 Alice 和 Bob。

### 新建分支

新建分支参考 Pro Git 的[这一章节](https://git-scm.com/book/zh/v2/Git-%E5%88%86%E6%94%AF-%E5%88%86%E6%94%AF%E7%9A%84%E6%96%B0%E5%BB%BA%E4%B8%8E%E5%90%88%E5%B9%B6)绝大多少情况下，我们都是从“当前”分支新建，只需要执行下面的命令就可以。

``` 
git checkout -b 新分支名
```

将会自动新建和移动到对应的分支上。这一操作可以在 [Learn Git Branching](https://learngitbranching.js.org/?locale=zh_CN) 小游戏基础篇的第二个关卡学习和实验。

建立分支可以让开发的代码和过程和主分支隔离开，在分支上进行操作，直到适当的时候将修改内容合并上去，这样可以减少你修改的内容对其他开发者的影响。

根据先前的故事来说，如果我和其他同事们，不同模块的代码开发在不同的分支上，那么他在使用从本地复制出来的项目代码进行（非常不推荐）提交和推送的时候，只要没有进行过分支合并，那么就不会影响其他人的代码从而导致冲突。

### 修改提交内容

在提交（commit）内容中，commit 信息填写的有一些问题提交的代码内容也有一些需要更改（新增或编辑）的，这时候，就可以[重新提交内容](https://git-scm.com/book/zh/v2/Git-%E5%9F%BA%E7%A1%80-%E6%92%A4%E6%B6%88%E6%93%8D%E4%BD%9C)。

如上面的示例，首先需要先暂存缺少的内容，然后再执行 ```git commit --amend```。这将会在终端中打开一个文件，```i``` 可以对你的提交信息进行修改，```Esc : wq``` 进行保存完成这次对提交内容的修改。

需要注意的是，这个修改只能在还未推送到远程分支的情况下进行，这一行为也会改变提交的哈希。

利用这个操作，可以有效的减少提交记录里那些小修小补的内容，使提交记录更加清晰明了。

在[Learn Git Branching](https://learngitbranching.js.org/?locale=zh_CN) 小游戏的高级篇的第四关“撤销变更”可以尝试如何撤销提交，这里就不赘述，分别是下面两个命令：

```
git reset HEAD~1
git revert HEAD
```

分别是撤销本地的一次提交和撤销远程的一次提交。

### 标签

``` shell
# 轻量标签
git tag v0.0.2-d

# 附注标签
git tag -a v0.0.1 -m "tag 测试"
```

---

其他命令：

``` shell
# 后期添加 tag，在最后加上提交的校验和
git tag -a <tag name> <hash>

# 上传某个 tag
git push origin <tagname>

# 上传所有 tag
git push origin --tags

# 删除 tag
git tag -d <tagname>

# 删除远程 tag
git push origin --delete <tagname>
```

> Git 支持两种标签：轻量标签（lightweight）与附注标签（annotated）。
轻量标签很像一个不会改变的分支——它只是某个特定提交的引用。
而附注标签是存储在 Git 数据库中的一个完整对象， 它们是可以被校验的，其中包含打标签者的名字、电子邮件地址、日期时间， 此外还有一个标签信息，并且可以使用 GNU Privacy Guard （GPG）签名并验证。 通常会建议创建附注标签，这样你可以拥有以上所有信息。但是如果你只是想用一个临时的标签， 或者因为某些原因不想要保存这些信息，那么也可以用轻量标签。
—— [Pro Git 2.6 章](https://git-scm.com/book/zh/v2/Git-%E5%9F%BA%E7%A1%80-%E6%89%93%E6%A0%87%E7%AD%BE)


检出（checkout，查看，移动到某个分支、提交或标签上）到某个标签上后，提交的内容不会有改变，需要检出到具体的哈希，或者直接从这个 tag 建立一个新的分支才行。但是 tag 并不会跟随你的提交进行改变，会导致标签和分支不同步或者割裂的情况。

tag 的使用可以让项目更加好区分一个个具体的版本，个人认为，tag 是用来区分每次发布的一个标记，用来方便后续对某个版本的代码的确定。无论是要重新打包或者修复 bug 都能提供一个清晰的依据。

## 关于 Git 的感悟

版本控制通过记录历史差异的方式，方便我们去查看文件的历史变化和保存不同的副本，这也将方便我们进行协作。
